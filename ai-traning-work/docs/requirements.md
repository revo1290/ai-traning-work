# 要件定義書

## プロジェクト概要

**プロジェクト名**: Splunk Training Tool (仮称)
**目的**: Splunkの操作を学習するための疑似トレーニング環境を提供する

## 対象ユーザー

- Splunk初心者
- 運用監視ツールを学びたいエンジニア

## 技術スタック

| 項目 | 技術 |
|------|------|
| フレームワーク | Next.js (App Router) |
| デプロイ | Vercel |
| データベース | SQLite (Turso) |
| UI | Splunk風ダークテーマ |

## 機能要件

### 1. ログ取り込み機能

- ファイルアップロードでログを取り込み
- 対応フォーマット:
  - Webアクセスログ (Apache/Nginx形式)
  - アプリケーションログ (JSON形式)
  - システムログ (syslog形式)
  - JVM GCログ (G1GC/ParallelGC形式)
  - Kubernetesログ (コンテナログ形式)
  - データベースログ (MySQL slow query等)
- サンプルデータを事前提供
- ユーザーによるデータ追加も可能

### 2. ログ検索・SPL機能

対応SPLコマンド（中級まで）:

**基本コマンド**
- `search` - キーワード検索
- `where` - 条件フィルタリング
- `table` - フィールド選択表示
- `sort` - ソート
- `head` / `tail` - 件数制限
- `dedup` - 重複除去

**統計コマンド**
- `stats` - 統計計算 (count, sum, avg, max, min)
- `top` - 上位N件
- `rare` - 下位N件
- `timechart` - 時系列グラフ用集計

**変換コマンド**
- `eval` - フィールド計算・作成
- `rex` - 正規表現によるフィールド抽出
- `rename` - フィールド名変更
- `fields` - フィールド選択/除外
- `spath` - JSON/XMLパース

**結合コマンド**
- `lookup` - ルックアップテーブルとの結合
- `join` - 複数ソースの結合
- `transaction` - トランザクション分析

### 3. ダッシュボード機能

- カスタマイズ可能なダッシュボード
- パネルの追加・編集・削除
- 対応チャート:
  - 折れ線グラフ
  - 棒グラフ
  - 円グラフ
  - テーブル
  - 単一値表示
- ドリルダウン機能（チャートクリックで詳細表示）

### 4. アラート機能

- 条件に基づくアラート設定
- 画面上での通知表示
- アラート履歴の確認
- ※実際の外部通知（メール等）は対象外

### 5. 検索支援機能

- **保存済み検索**: よく使うクエリを保存・再利用
- **クエリ履歴**: 過去の検索を一覧表示・再実行
- **SPLテンプレート・例文集**: 初心者向けクエリ例を提供
- **エクスポート**: 検索結果をCSV/JSON形式でダウンロード

### 6. フィールド抽出設定

- カスタムフィールドの定義
- 正規表現によるフィールド抽出ルール設定
- 抽出ルールの保存・管理

### 7. 学習支援機能

- **SPL構文エラー表示**: クエリのエラー箇所をハイライト表示
- **コマンドヘルプ**: 入力中にコマンド説明をポップアップ表示
- **練習問題モード**: 課題を出してクエリを書く練習ができる

## 非機能要件

- ユーザー認証: なし（シングルユーザー）
- ガイド機能: なし
- レスポンス: 検索結果は3秒以内に表示

## データ永続化

- SQLite (Turso) を使用
- 保存対象:
  - 取り込んだログデータ
  - ダッシュボード設定
  - アラート設定
  - アラート履歴

## UIデザイン方針

- Splunkに似たダークテーマ
- 左サイドバーにナビゲーション
- 検索バーを画面上部に配置
- 時間範囲選択機能
